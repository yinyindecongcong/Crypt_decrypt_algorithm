---
typora-root-url: img
typora-copy-images-to: img
---

### Crypt_decrypt_algorithm

#### 古典密码

##### Caesar密码 

对字母表中的每个字母，用它之后的第三个字母代替。

##### Playfair密码（implement at 2018/11/10）（单表多字母代替密码）

给定一个密钥词，生成一个`5 x 5`的字母矩阵，生成过程为首先将密钥词去重后从左往右排列，再将剩余的字母从左往右填充至矩阵中，其中`I/J`算作一个字母，如monarchy生成如下矩阵。

![1541836079333](/1541836079333.png)

对明文按如下规则加密：

1. 将明文分割成字母对，若字母对字母相同，在中间加一个填充字母，如x。`eg:balloon先变成ba,lx,lo,on`

2. 对每个字母对——
   * 若字母在矩阵的同一行，则每个字母由其右边的字母代替，`eg: AR->RM`
   * 若字母在矩阵的同一列，则每个字母由其下边的字母代替，`eg: MU->CM`
   * 否则对每个字母，其行为密文的所在行，另一字母的列为密文所在列，`eg:HS->BP`

##### Hill密码（单表多字母代替密码）

给定一个`m x m`的矩阵密钥，如`m = 3`，——

* 加密过程：$C = E(K,P) = PK \ mod \ 26$   
* 解密过程：$P = D(K,C)=PKK^{-1}\  mod \ 26$ 

##### Vigenere密码（多表代替密码）

* 最简单的多表代替密码，即使用不同的单表代替
* 代替表为 $m$ 个Caesar代替表，$m$ 的大小由密钥词决定 
* 加密过程为: $C_i = (p_i + k_{i\  mod \ m}) \ mod\  26$
* 解密过程为: $C_i = (p_i - k_{i\  mod \ m}) \ mod\  26$ 

##### 栅栏加密（置换密码）

一行一行写出单词，然后按列读出，但是把列的次序打乱，列的次序就是算法的密钥。

##### 转轮机（多次代替密码）

转轮机由多个圆筒组成，每个圆筒有26个输入引脚和26个输出引脚，分别表示26个字母。

考虑只有一个圆筒的转轮机，每输入一个字符，圆筒就旋转一个位置，内部连线相应改变，即为一个周期为26的多表代替密码。

多个圆筒时，每输入一个字符，第一个圆筒就旋转一个位置；当第一个圆筒旋转一周时，第二个圆筒旋转一个位置，以此类推。

#### 对称密码

##### 数据加密算法DEA（数据加密标准DES）

1. **Feistel密码**

输入为长为 $2w$ 的明文，分为下图的 $LE_0, RE_0$ ，密钥为 $K$，推出每一轮的密钥 $K_i$，算法加密解密如下：

![1542037160776](/1542037160776.png)

2. DEA的主体部分是Feistel密码，整个机制大致如下图：

<img src="1542038028155.png" width=500>





#### 公钥加密算法

五维组（明文，加密算法，密文，公钥与私钥，解密算法）

每个用户生成一对公钥与私钥，公钥所有人可见，私钥仅自己可见，且从公钥获得私钥在计算上不可行。

* 用于加密，如下：

$$
Y=E(PU_B,X)\\
X=D(PR_B,Y)
$$

* 用于数字签名，如下：(由于任何人都可以解密，不安全)

$$
Y=E(PR_A,X)\\
X=D(PU_A,Y)
$$

* 使用两次公钥算法，提供认证与保密功能，如下：

$$
Z=E(PU_B,E(PR_A,X))\\
X=D(PU_A,D(PR_B,Z))
$$

##### RSA

五维组——

* 明文：`0`到某`n-1`之间的整数，通常n为1024bit的二进制数（309位十进制数）

* 加密算法：乘方取模

* 密文：`0`到某`n-1`之间的整数，通常n为1024bit的二进制数（309位十进制数）

* 公钥与私钥

* 解密算法：乘方取模

RSA是一种分组密码，在实际应用中，分组大小为 $i$，其中 $2^i < n \le 2^{i+1}$，加密解密过程如下：
$$
\begin{align}
C &= M^e \ mod \ n\\
M &= C^d \ mod \ n = (M^e)^d \ mod \ n=M^{ed}\ mod \ n
\end{align}
$$
